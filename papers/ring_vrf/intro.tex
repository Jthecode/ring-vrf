% \section{Introduction}

\def\qaudbreak{\eprint{\quad}{\\}}

% A {\it ring verifiable random function} (ring VRF) is a ring signature that proves correct evaluation of some pseudo-random function (PRF) determined by the actual key pair used in signing. 

We introduce ring verifiable random functions (ring VRFs) as a natural
fulcrum around which anonymous credentials turn, in formalization,
in optimizations, in the nuances of use-cases, and in miss-use resistance.
%
Along with some formalizations, we explain portions of their unfolding
story which address three questions:
\begin{enumerate} 
\item
What are the cheapest SNARK proofs?  \qaudbreak
Ones users reuse without reproving.
% \item
% How can credentials use be contextual?  \qaudbreak
% Prove evaluation of a secret function.
\item
How can identity be safe for general use?  \qaudbreak
By revealing nothing except users' uniqueness.
\item
How can ration card issuance be transparent?  \qaudbreak
By asking users trust a public list, not certificates.
\end{enumerate}

% First
\paragraph{Zero-knowledge continuations:}

Rerandomizable zkSNARKs like Groth16 \cite{Groth16} admit a
transformation of a valid proof into another valid but unlinkable
proof of the exact same statement.  In practice, rerandomization
was never deployed because the public inputs link the usages.

We demonstrate in \S\ref{sec:rvrf_cont} a simple transformation of
any Groth16 zkSNARK into a {\it zero-knowledge continuation} whose
public inputs become opaque Pedersen commitments, with cheaply
rerandomizable blinding factors and proofs.
These zero-knowledge continuations then prove validity of the contents
of Pedersen commitments, but can now be reused arbitrarily many times,
without linking the usages. 

As recursive SNARKs shall remain extremely slow,
we expect zero-knowledge continuations via rerandomization become
essential for zkSNARKs used outside the crypto-currency space.

% \smallskip 
\paragraph{Ring VRFs:}

A ring signature proves only that its actual signer lies in a ``ring''
of public keys, without revealing which signed.
A {\it verifiable random function} (VRF) is a signature that proves
correct evaluation of a PRF defined by the signer's key.
% but nuances exist .

A {\it ring verifiable random function} (ring VRF) is a ring signature, in
that it anonymizes its actual signer within a ring of plausible signers,
but also proves correct evaluation of a pseudo-random function (PRF)
defined by the actual signer's key. % (see \S\ref{sec:rvrf_games}).
%
Ring VRF outputs provide linking proofs between different signatures iff
the signatures have identical inputs, as well as pseudo-randomness.

We build extremely efficient and flexible ring VRFs by amortizing a
zero-knowledge continuation that unlinkably proves ring membership
of a secret key, and then cheaply proving individual VRF evaluations.

As the PRF output is uniquely determined by the signed message and
signer's actual secret key, we can therefore link signatures by the
same signer if and only if they sign identical messages.
In effect, ring VRFs restrict anonymity similarly to but less than
 linkable ring signatures do, which makes them multi-use and contextual.

We define the security of  ring VRFs in both the standard model
and in the universally composable (UC) \cite{canetti1,canetti2} model. 
We show that our ring VRF protocol is secure in the UC model.

% Second
% \smallskip
\paragraph{Identity uses:}

As an identity system, ring VRFs evaluated on a specific context or
domain name output a unique identity for the signer at that domain or
in that context (see \S\ref{sec:app_identity}).
In this way, they permit banning specific users and prevent Sybil behavior.
Yet users' activities remain unlinkable across distinct contexts or
domains, meaning correctly deployed ring VRF based credentials
only prevent users being Sybil, nothing more.  We argue this yields
diverse legally and ethically straightforward identity usages.

As a problematic contract, attribute based credential schemes like
IRMA (``I Reveal My Attributes'') credentials \cite{IRMAcredentials}
are being marketed as an online privacy solution, but they cannot prevent
users being Sybil if they reveal numerous attributes, meaning they provide little or no privacy.
IRMA might improve privacy in narrow situations of course, but
overall attribute based credentials should {\it never} be considered
fit for general purpose usage, aka the prevention of Sybil behavior.

Aside from general purpose identity, our existing offline
verification processes often better protect user privacy and human
rights than adopting online processes like IRMA.
%
In particular, there are many proposals by the W3C for attribute based
credential usage in \cite{w3c_vc_use_cases}, but broadly speaking they
all bring matching harmful uses.  % https://www.w3.org/TR/vc-use-cases/
As an example, if users could easily prove their employment online, which
the W3C claims helps users apply for bank accounts, then job application
sites could similarly demand proof of current employment, a clear injustice.
Average users apply for jobs far more often than they open bank accounts.

In general, abuse risks like this dictate that IRMA verifiers should be
tightly controlled by legislation, which becomes difficult internationally. 
%
Ring VRFs avoid these abuse risks by being truly unlinkable, and thus
yield anonymous credentials which safely avoid legal restrictions.

{\it Any ethical general purpose identity system should be based
upon ring VRFs, not attribute based credentials like IRMA.}

We credit Bryan Ford's work on proof-of-personhood parties \cite{pop2008,pop2017}
% https://bford.info/pub/dec/pop-abs/  https://bford.info/pub/net/sybil-abs/
with first espousing the idea that anonymous credentials should produce
contextual unique identifiers, without leaking other user attributes.

As a rule, there exist simple VRF variants for all anonymous credentials,
including IRMA \cite{IRMAcredentials} or group signatures \cite{group_sig_survey}.
We focus exclusively upon ring VRFs for brevity, and because alone
ring VRFs contextual linkability covers the most important use cases.
% and our optimizations make ring VRFs extremely efficient.

% Third
% \smallskip
\paragraph{Rationing uses:}

Ring VRFs yield rate limiting or rationing systems, which work
similarly to identity applications, except their VRF inputs should also
include an approximate date and a bounded counter, and
 then their outputs should be tracked as nullifiers.
Yet, these nullifiers need only temporarily storage, which improves 
efficiency over anonymous money schemes like ZCash and blind signed tokens.

We expect a degree of fraud whenever deploying purely certificate
based systems, as witnessed by the litany of fraudulent TLS and covid
certificates.  Ring VRFs help mitigate fraudulent certificate concerns
because the ring is a database and can be audited.

We know governments have ultimately little choice but to institute
rationing in response to shortages caused by climate change, ecosystem
collapse, and peak oil.  Ring VRFs could help avoid ration card fraud,
and thereby reduce social unrest, while also protecting essential privacy.

Ring VRFs need heavier verifiers than single-use token credentials
based on OPRFs \cite{PrivacyPass} or blind signatures.
Yet, ring VRFs avoid these schemes separate issuance phase entirely,
and sometimes even their registration phase.  Instead, fresh tokens
merely require adjusting the approximate date in the VRF input.
This reduces complexity, simplifies scaling, and increases flexibility.

In particular, if governments issue ration cards based upon ring VRFs
then these credentials could safely support other use cases, like
free tiers in online services or games, and advertiser promotions,
as well as identity applications like prevention of spam and online abuse.

In this, we need authenticated domain separation of products or identity
consumers in queries to users' ring VRF credentials.  We briefly discuss
some sensible patterns in \S\ref{subsec:app_ration_carts} below, but
overall authenticated domain separation resemble TLS certificates except
simpler in that roots of trust can self authenticate if root keys act as
domain separators.

% \paragraph{Outline:}




\endinput




As a field, anonymous credentials come in myriad flavors,
many of which exist to limits the anonymity provided, ala
 attribute based credentials and group signatures. % \cite{group_sig_survey}.
% aka anonymized signatures
%
Ring VRFs by weakening anonymity only contextually provide a safer,
more private, more flexible, more powerful, and more ethical
choice for all everyday anonymous credential use cases.  % needs:  ???


